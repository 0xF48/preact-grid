!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.PreactGrid=e():t.PreactGrid=e()}(window,function(){return function(t){var e={};function i(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=9)}([function(t,e,i){"use strict";i.r(e),i.d(e,"h",function(){return o}),i.d(e,"createElement",function(){return o}),i.d(e,"cloneElement",function(){return a}),i.d(e,"Component",function(){return E}),i.d(e,"render",function(){return I}),i.d(e,"rerender",function(){return c}),i.d(e,"options",function(){return r});var r={},s=[],n=[];function o(t,e){var i,o,h,l,a=n;for(l=arguments.length;l-- >2;)s.push(arguments[l]);for(e&&null!=e.children&&(s.length||s.push(e.children),delete e.children);s.length;)if((o=s.pop())&&void 0!==o.pop)for(l=o.length;l--;)s.push(o[l]);else"boolean"==typeof o&&(o=null),(h="function"!=typeof t)&&(null==o?o="":"number"==typeof o?o=String(o):"string"!=typeof o&&(h=!1)),h&&i?a[a.length-1]+=o:a===n?a=[o]:a.push(o),i=h;var u=new function(){};return u.nodeName=t,u.children=a,u.attributes=null==e?void 0:e,u.key=null==e?void 0:e.key,void 0!==r.vnode&&r.vnode(u),u}function h(t,e){for(var i in e)t[i]=e[i];return t}var l="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function a(t,e){return o(t.nodeName,h(h({},t.attributes),e),arguments.length>2?[].slice.call(arguments,2):t.children)}var u=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,p=[];function d(t){!t._dirty&&(t._dirty=!0)&&1==p.push(t)&&(r.debounceRendering||l)(c)}function c(){var t,e=p;for(p=[];t=e.pop();)t._dirty&&S(t)}function f(t,e){return t.normalizedNodeName===e||t.nodeName.toLowerCase()===e.toLowerCase()}function m(t){var e=h({},t.attributes);e.children=t.children;var i=t.nodeName.defaultProps;if(void 0!==i)for(var r in i)void 0===e[r]&&(e[r]=i[r]);return e}function v(t){var e=t.parentNode;e&&e.removeChild(t)}function _(t,e,i,r,s){if("className"===e&&(e="class"),"key"===e);else if("ref"===e)i&&i(null),r&&r(t);else if("class"!==e||s)if("style"===e){if(r&&"string"!=typeof r&&"string"!=typeof i||(t.style.cssText=r||""),r&&"object"==typeof r){if("string"!=typeof i)for(var n in i)n in r||(t.style[n]="");for(var n in r)t.style[n]="number"==typeof r[n]&&!1===u.test(n)?r[n]+"px":r[n]}}else if("dangerouslySetInnerHTML"===e)r&&(t.innerHTML=r.__html||"");else if("o"==e[0]&&"n"==e[1]){var o=e!==(e=e.replace(/Capture$/,""));e=e.toLowerCase().substring(2),r?i||t.addEventListener(e,x,o):t.removeEventListener(e,x,o),(t._listeners||(t._listeners={}))[e]=r}else if("list"!==e&&"type"!==e&&!s&&e in t)!function(t,e,i){try{t[e]=i}catch(t){}}(t,e,null==r?"":r),null!=r&&!1!==r||t.removeAttribute(e);else{var h=s&&e!==(e=e.replace(/^xlink\:?/,""));null==r||!1===r?h?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.removeAttribute(e):"function"!=typeof r&&(h?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),r):t.setAttribute(e,r))}else t.className=r||""}function x(t){return this._listeners[t.type](r.event&&r.event(t)||t)}var y=[],g=0,b=!1,w=!1;function C(){for(var t;t=y.pop();)r.afterMount&&r.afterMount(t),t.componentDidMount&&t.componentDidMount()}function M(t,e,i,r,s,n){g++||(b=null!=s&&void 0!==s.ownerSVGElement,w=null!=t&&!("__preactattr_"in t));var o=k(t,e,i,r,n);return s&&o.parentNode!==s&&s.appendChild(o),--g||(w=!1,n||C()),o}function k(t,e,i,r,s){var n=t,o=b;if(null!=e&&"boolean"!=typeof e||(e=""),"string"==typeof e||"number"==typeof e)return t&&void 0!==t.splitText&&t.parentNode&&(!t._component||s)?t.nodeValue!=e&&(t.nodeValue=e):(n=document.createTextNode(e),t&&(t.parentNode&&t.parentNode.replaceChild(n,t),N(t,!0))),n.__preactattr_=!0,n;var h,l,a=e.nodeName;if("function"==typeof a)return function(t,e,i,r){var s=t&&t._component,n=s,o=t,h=s&&t._componentConstructor===e.nodeName,l=h,a=m(e);for(;s&&!l&&(s=s._parentComponent);)l=s.constructor===e.nodeName;s&&l&&(!r||s._component)?(U(s,a,3,i,r),t=s.base):(n&&!h&&(D(n),t=o=null),s=T(e.nodeName,a,i),t&&!s.nextBase&&(s.nextBase=t,o=null),U(s,a,1,i,r),t=s.base,o&&t!==o&&(o._component=null,N(o,!1)));return t}(t,e,i,r);if(b="svg"===a||"foreignObject"!==a&&b,a=String(a),(!t||!f(t,a))&&(h=a,(l=b?document.createElementNS("http://www.w3.org/2000/svg",h):document.createElement(h)).normalizedNodeName=h,n=l,t)){for(;t.firstChild;)n.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(n,t),N(t,!0)}var u=n.firstChild,p=n.__preactattr_,d=e.children;if(null==p){p=n.__preactattr_={};for(var c=n.attributes,x=c.length;x--;)p[c[x].name]=c[x].value}return!w&&d&&1===d.length&&"string"==typeof d[0]&&null!=u&&void 0!==u.splitText&&null==u.nextSibling?u.nodeValue!=d[0]&&(u.nodeValue=d[0]):(d&&d.length||null!=u)&&function(t,e,i,r,s){var n,o,h,l,a,u=t.childNodes,p=[],d={},c=0,m=0,_=u.length,x=0,y=e?e.length:0;if(0!==_)for(var g=0;g<_;g++){var b=u[g],w=b.__preactattr_,C=y&&w?b._component?b._component.__key:w.key:null;null!=C?(c++,d[C]=b):(w||(void 0!==b.splitText?!s||b.nodeValue.trim():s))&&(p[x++]=b)}if(0!==y)for(var g=0;g<y;g++){l=e[g],a=null;var C=l.key;if(null!=C)c&&void 0!==d[C]&&(a=d[C],d[C]=void 0,c--);else if(!a&&m<x)for(n=m;n<x;n++)if(void 0!==p[n]&&(M=o=p[n],R=s,"string"==typeof(P=l)||"number"==typeof P?void 0!==M.splitText:"string"==typeof P.nodeName?!M._componentConstructor&&f(M,P.nodeName):R||M._componentConstructor===P.nodeName)){a=o,p[n]=void 0,n===x-1&&x--,n===m&&m++;break}a=k(a,l,i,r),h=u[g],a&&a!==t&&a!==h&&(null==h?t.appendChild(a):a===h.nextSibling?v(h):t.insertBefore(a,h))}var M,P,R;if(c)for(var g in d)void 0!==d[g]&&N(d[g],!1);for(;m<=x;)void 0!==(a=p[x--])&&N(a,!1)}(n,d,i,r,w||null!=p.dangerouslySetInnerHTML),function(t,e,i){var r;for(r in i)e&&null!=e[r]||null==i[r]||_(t,r,i[r],i[r]=void 0,b);for(r in e)"children"===r||"innerHTML"===r||r in i&&e[r]===("value"===r||"checked"===r?t[r]:i[r])||_(t,r,i[r],i[r]=e[r],b)}(n,e.attributes,p),b=o,n}function N(t,e){var i=t._component;i?D(i):(null!=t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),!1!==e&&null!=t.__preactattr_||v(t),P(t))}function P(t){for(t=t.lastChild;t;){var e=t.previousSibling;N(t,!0),t=e}}var R={};function T(t,e,i){var r,s=R[t.name];if(t.prototype&&t.prototype.render?(r=new t(e,i),E.call(r,e,i)):((r=new E(e,i)).constructor=t,r.render=L),s)for(var n=s.length;n--;)if(s[n].constructor===t){r.nextBase=s[n].nextBase,s.splice(n,1);break}return r}function L(t,e,i){return this.constructor(t,i)}function U(t,e,i,s,n){t._disable||(t._disable=!0,(t.__ref=e.ref)&&delete e.ref,(t.__key=e.key)&&delete e.key,!t.base||n?t.componentWillMount&&t.componentWillMount():t.componentWillReceiveProps&&t.componentWillReceiveProps(e,s),s&&s!==t.context&&(t.prevContext||(t.prevContext=t.context),t.context=s),t.prevProps||(t.prevProps=t.props),t.props=e,t._disable=!1,0!==i&&(1!==i&&!1===r.syncComponentUpdates&&t.base?d(t):S(t,1,n)),t.__ref&&t.__ref(t))}function S(t,e,i,s){if(!t._disable){var n,o,l,a=t.props,u=t.state,p=t.context,d=t.prevProps||a,c=t.prevState||u,f=t.prevContext||p,v=t.base,_=t.nextBase,x=v||_,b=t._component,w=!1;if(v&&(t.props=d,t.state=c,t.context=f,2!==e&&t.shouldComponentUpdate&&!1===t.shouldComponentUpdate(a,u,p)?w=!0:t.componentWillUpdate&&t.componentWillUpdate(a,u,p),t.props=a,t.state=u,t.context=p),t.prevProps=t.prevState=t.prevContext=t.nextBase=null,t._dirty=!1,!w){n=t.render(a,u,p),t.getChildContext&&(p=h(h({},p),t.getChildContext()));var k,P,R=n&&n.nodeName;if("function"==typeof R){var L=m(n);(o=b)&&o.constructor===R&&L.key==o.__key?U(o,L,1,p,!1):(k=o,t._component=o=T(R,L,p),o.nextBase=o.nextBase||_,o._parentComponent=t,U(o,L,0,p,!1),S(o,1,i,!0)),P=o.base}else l=x,(k=b)&&(l=t._component=null),(x||1===e)&&(l&&(l._component=null),P=M(l,n,p,i||!v,x&&x.parentNode,!0));if(x&&P!==x&&o!==b){var E=x.parentNode;E&&P!==E&&(E.replaceChild(P,x),k||(x._component=null,N(x,!1)))}if(k&&D(k),t.base=P,P&&!s){for(var I=t,j=t;j=j._parentComponent;)(I=j).base=P;P._component=I,P._componentConstructor=I.constructor}}if(!v||i?y.unshift(t):w||(t.componentDidUpdate&&t.componentDidUpdate(d,c,f),r.afterUpdate&&r.afterUpdate(t)),null!=t._renderCallbacks)for(;t._renderCallbacks.length;)t._renderCallbacks.pop().call(t);g||s||C()}}function D(t){r.beforeUnmount&&r.beforeUnmount(t);var e=t.base;t._disable=!0,t.componentWillUnmount&&t.componentWillUnmount(),t.base=null;var i=t._component;i?D(i):e&&(e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),t.nextBase=e,v(e),function(t){var e=t.constructor.name;(R[e]||(R[e]=[])).push(t)}(t),P(e)),t.__ref&&t.__ref(null)}function E(t,e){this._dirty=!0,this.context=e,this.props=t,this.state=this.state||{}}function I(t,e,i){return M(i,t,{},!1,e,!1)}h(E.prototype,{setState:function(t,e){var i=this.state;this.prevState||(this.prevState=h({},i)),h(i,"function"==typeof t?t(i,this.props):t),e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),d(this)},forceUpdate:function(t){t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),S(this,2)},render:function(){}});var j={h:o,createElement:o,cloneElement:a,Component:E,render:I,rerender:c,options:r};e.default=j},function(t,e,i){var r,s,n,o,h=function(t,e){if(!(t instanceof e))throw new Error("Bound instance method accessed before binding")};({h:o,Component:r}=i(0)),s={w:1,h:1,visible:!1,style:{},ease:null,scale_start:.9,startMatrixString:null},(n=class t extends r{constructor(t){if(super(t),this.hide=this.hide.bind(this),this.show=this.show.bind(this),this.resize=this.resize.bind(this),this.link_ref=this.link_ref.bind(this),this.rand=this.rand.bind(this),this.state={visible:!1,update:!1,pw:0},0===t.w||0===t.h)throw new Error("Invalid grid item w/h ("+w+","+o+")")}shouldComponentUpdate(t,e){return!(!this._item||!this._item.parentNode)&&(this.props.visible!==t.visible?!1===t.visible?this.hide():!0===t.visible&&this.show():this._item.parentNode.clientWidth!==this.state.pw&&0!==this.state.pw&&(this.state.pw=this._item.parentNode.clientWidth,setTimeout(this.resize,0)),!1)}hide(){return h(this,t),this._item.style.visibility="hidden"}show(){if(h(this,t),this._item)return this.state.visible=!0,this._item.style.visibility="",this._item.style.transition=this.getTransition(),this._item.style.transform=this.endTransform()}resize(){return h(this,t),this.state.dim=this.getDim(),this._item.style.transition="",this._item.style.transform=this.endTransform(),this._item.style.width=this.state.dim.w,this._item.style.height=this.state.dim.h}getDim(){var t,e,i,r,s,n;return t=this.context.dim,i=this.context.length_dim,this.context.vert?(r=this.props.c*t,n=t*this.props.w,s=this.props.r*i+this.context.startPadding,e=this.props.h*i):(s=this.props.c*t,e=t*this.props.w,r=this.props.r*i+this.context.startPadding,n=this.props.h*i),{x:r,y:s,w:n,h:e,vert:e>n||e===n&&this.rand()>0}}link_ref(e){return h(this,t),this._item=e}rand(){return h(this,t),-this.context.variation+Math.random()*this.context.variation*2}componentDidMount(){if(this.state.pw=this._item.parentNode.clientWidth,clearTimeout(this.show),this.props.visible!==this.state.visible&&!0===this.props.visible)return setTimeout(this.show,50+50*this.rand())}componentWillUnmount(){return this.state.visible=!1,clearTimeout(this.show)}startTransform(){var t,e,i,r,s,n;return t=this.context.scroll_up&&Math.PI/2+.3||-Math.PI/2-.3,e=.5+.2*this.rand(),i=Math.floor(100*Math.cos(t))/100,r=Math.floor(100*Math.sin(t))/100,s=-Math.floor(100*Math.sin(t))/100,n=Math.floor(100*Math.cos(t))/1e3,"matrix3d("+(this.state.dim.vert?[i*e,.1*this.rand(),r*e,0,.1*this.rand(),1*e,0,0,s*e,.1*this.rand(),n*e,0,this.state.dim.x,this.state.dim.y,0,1]:[1*e,0,0,0,0,i*e,r*e,0,0,s*e,n*e,0,this.state.dim.x,this.state.dim.y,0,1]).join(",")+")"}endTransform(){return"translate("+this.state.dim.x+"px,"+this.state.dim.y+"px)"}getTransition(){return"transform "+(null!==this.props.ease?this.props.ease:this.context.ease)}render(){var t;return this.state.dim=this.getDim(),t={visibility:"hidden",transform:this.startTransform(),height:this.state.dim.h,width:this.state.dim.w},o("div",{className:"-i-grid-item "+(this.props.className||""),ref:this.link_ref,style:t},this.props.children)}}).defaultProps=s,t.exports=n},function(t,e){var i,r,s,n,o=function(t,e){if(!(t instanceof e))throw new Error("Bound instance method accessed before binding")};n=function(t,e,i){return Math.min(Math.max(t,e),i)},i=class{constructor(t,e,i,r){this.set(t,e,i,r)}set(t,e,i,r){return this.x1=t||0,this.x2=e||0,this.y1=i||0,this.y2=r||0,this}copy(t){return this.x1=t.x1,this.x2=t.x2,this.y1=t.y1,this.y2=t.y2,this}normalize(){return this.x1<0&&(this.x2-=this.x1,this.x1=0),this.y1<0&&(this.y2-=this.y1,this.y1=0),this}loopMatrix(t,e,i,r,s){var n,o,h,l,a,u,p,d;for(d=n=h=this.y1,l=this.y2;h<=l?n<l:n>l;d=h<=l?++n:--n)if(!(d<0)){if(d>t.length)return!1;for(p=o=a=this.x1,u=this.x2;a<=u?o<u:o>u;p=a<=u?++o:--o)if(void 0!==t[d][p]&&!1===e(t[d][p],p,d,i,r,s))return log("ret"),!1}return!0}loopRect(t,e,i,r){var s,n,o,h,l,a,u,p;for(p=s=o=this.y1,h=this.y2;o<=h?s<h:s>h;p=o<=h?++s:--s)for(u=n=l=this.x1,a=this.x2;l<=a?n<a:n>a;u=l<=a?++n:--n)if(t(u,p,e,i,r))return!1;return!0}},r=class extends i{constructor(t){t.x2=t.width,t.y2=t.height,super(0,t.width,0,t.height),this.item=t.item,this.rect=t.rect||null}setXY(t,e){return this.rect.set(t,t+this.x2,e,e+this.y2)}},s=class t extends i{constructor(t){super(),this.clearCoord=this.clearCoord.bind(this),this.isItemNull=this.isItemNull.bind(this),this.isCoordEmpty=this.isCoordEmpty.bind(this),this.setCoordItem=this.setCoordItem.bind(this),this.clearItem=this.clearItem.bind(this),this.check_holes=null==t.check_holes||t.check_holes,this._temp=[new i,new i,new i],this.offset_x=0,this.offset_y=0,this.matrix=[],this.removed=[],this.full=new i(t.width-1,0,t.height-1,0),this.full.count_x=[],this.full.count_y=[],this.set(0,t.width,0,t.height)}clearCoord(e,i,r){return o(this,t),this.matrix[r][i]&&(this.decrY(r),this.decrX(i)),this.matrix[r][i]=null,!0}isItemNull(e){return o(this,t),null===e}isCoordEmpty(e,i){return o(this,t),null===this.matrix[i][e]}setCoordItem(e,i,r,s){if(o(this,t),e)throw new Error("setCoord, coord taken ["+i+","+r+"] by "+e);return this.matrix[r][i]=[s,i-s.rect.x1,r-s.rect.y1],this.incrY(r),this.incrX(i)}decrY(t){if(this.full.count_y[t]--,this.full.y1>t&&(this.full.y1=t),this.full.y2>t)return this.full.y2=t}decrX(t){if(this.full.count_x[t]--,this.full.x1>t&&(this.full.x1=t),this.full.x2>t)return this.full.x2=t}incrY(t){var e,i,r,s,n,o,h;if(this.full.count_y[t]++,this.full.count_y[t]===this.width){if(t<this.full.y1){if(this.check_holes)for(h=e=r=t,s=this.full.y1;r<=s?e<s:e>s;h=r<=s?++e:--e)if(this.full.count_y[h]!==this.width)return;return this.full.y1=t}if(this.check_holes)for(h=i=n=this.full.y1,o=t;n<=o?i<o:i>o;h=n<=o?++i:--i)if(this.full.count_y[h]!==this.width)return;return this.full.y2=t}}incrX(t){var e,i,r,s,n,o,h;if(this.full.count_x[t]++,this.full.count_x[t]===this.width){if(t<this.full.x1){if(this.check_holes)for(h=e=r=t,s=this.full.x1;r<=s?e<s:e>s;h=r<=s?++e:--e)if(this.full.count_x[h]!==this.width)return;return this.full.x1=t}if(this.check_holes)for(h=i=n=this.full.x1,o=t;n<=o?i<o:i>o;h=n<=o?++i:--i)if(this.full.count_y[h]!==this.width)return;return this.full.x2=t}}clearRect(t){return t.loopMatrix(this.matrix,this.clearItem)}clearItem(e,i,r){var s,n,h,l,a,u,p,d,c,f,m;if(o(this,t),!e)return falsel;if(s=e[0],f=i-e[1],m=r-e[2],!s.rect)throw new Error("cant clear item, item has no rect. "+f+","+m);for(h=l=u=m,p=m+s.y2;u<=p?l<p:l>p;h=u<=p?++l:--l)for(n=a=d=f,c=f+s.x2;d<=c?a<c:a>c;n=d<=c?++a:--a)this.clearCoord(s,n,h);return s.rect=null}clearY(t){var e,i,r,s,n;for(s=[],n=e=0,i=(r=this.matrix[t]).length;e<i;n=++e)r[n],s.push(this.clearItem(this.matrix[t][n],n,t));return s}clearLinkedX(t,e){var i,r,s,n,o,h;for(n=[],h=i=0,r=(s=this.matrix).length;i<r;h=++i)(o=s[h])[t]&&o[e]&&o[e][0]===o[t][0]?n.push(this.clearItem(o[t],t,h)):n.push(void 0);return n}clearLinkedY(t,e){var i,r,s,n,o,h;for(n=[],h=i=0,r=(s=this.matrix[t]).length;i<r;h=++i)(o=s[h])&&this.matrix[e]&&this.matrix[e][h][0]===o[0]?n.push(this.clearItem(o,h,t)):n.push(void 0);return n}clearX(t){var e,i,r,s,n,o;for(s=[],o=e=0,i=(r=this.matrix).length;e<i;o=++e)n=r[o],s.push(this.clearItem(n[t],t,o));return s}insertX(t,e){var i,r,s,o;for(this.clearLinkedX(t,n(t-1,0,this.x2-1)),this.full.x1>t?this.full.x1+=e:this.full.x1=this.x2-1,this.full.x2>t&&(this.full.x2=0),this.full.y1=this.y2,this.full.y2=0,s=[],i=0,r=e;0<=r?i<r:i>r;0<=r?++i:--i)this.full.count_x.splice(t,0,0),s.push(function(){var e,i,r,s;for(s=[],e=0,i=(r=this.matrix).length;e<i;e++)o=r[e],s.push(o.splice(t,0,null));return s}.call(this));return s}insertY(t,e){var i,r,s;for(this.clearLinkedY(t,n(t-1,0,this.y2-1)),this.full.y1<t&&(this.full.y1=t+e),s=[],i=0,r=e;0<=r?i<r:i>r;0<=r?++i:--i)this.full.count_y.splice(t,0,0),s.push(this.matrix.splice(t,0,new Array(this.x2).fill(null)));return s}set(t,e,r,s){var n,o,h,l,a,u,p,d,c,f,m,v,_,x,y,g,b,w,C,M,k,N,P,R,T,L,U,S,D,E;if(this.height||(this.height=0),this.width||(this.width=0),void 0===this.x1)return super.set(t,e,r,s);if((n=new i(t-this.x1,e-this.x2,r-this.y1,s-this.y2)).y1-n.y2>this.height)throw new Error("set: Y out of bounds");if(n.x1-n.x2>this.width)throw new Error("set: X out of bounds");if(n.x2>0)for(o=h=0,y=n.x2;0<=y?h<y:h>y;o=0<=y?++h:--h)for(this.full.count_x.push(0),l=0,u=(g=this.matrix).length;l<u;l++)g[l].push(null);else if(n.x2<0)for(o=a=0,C=n.x2;0<=C?a<C:a>C;o=0<=C?++a:--a)for(this.clearX(this.x2-1+o),this.full.count_x.pop(),f=0,p=(M=this.matrix).length;f<p;f++)M[f].pop();if(this.x2=e,n.x1<0)for(o=m=0,k=n.x1;0<=k?m<k:m>k;o=0<=k?++m:--m)for(this.full.count_x.unshift(0),this.full.x2++,this.full.x1++,this.offset_x--,v=0,d=(N=this.matrix).length;v<d;v++)N[v].unshift(null);else if(n.x1>0)for(o=_=0,P=n.x1;0<=P?_<P:_>P;o=0<=P?++_:--_)for(this.clearX(0),this.full.x2--,this.full.x1--,this.offset_x++,this.full.count_x.shift(),x=0,c=(R=this.matrix).length;x<c;x++)R[x].shift();if(this.x1=t,n.y2>0)for(o=U=0,T=n.y2;0<=T?U<T:U>T;o=0<=T?++U:--U)this.full.count_y.push(0),this.matrix.push(new Array(this.x2-this.x1).fill(null));else if(n.y2<0)for(o=S=0,L=n.y2;0<=L?S<L:S>L;o=0<=L?++S:--S)this.clearY(this.y2-1+o),this.full.count_y.pop(),this.matrix.pop();if(this.y2=s,n.y1>0)for(o=D=0,b=n.y1;0<=b?D<b:D>b;o=0<=b?++D:--D)this.clearY(0),this.full.y2--,this.full.y1--,this.offset_y++,this.full.count_y.shift(),this.matrix.shift();else if(n.y1<0)for(o=E=0,w=n.y1;0<=w?E<w:E>w;o=0<=w?++E:--E)this.offset_y--,this.full.y2++,this.full.y1++,this.full.count_y.unshift(0),this.full.x1=0,this.full.x2=0,this.matrix.unshift(new Array(this.x2-this.x1).fill(null));return this.y1=r,this.normalize(),n.x2-n.x1>0&&(this.full.y1=this.y2-1,this.full.y2=this.y1),n.y2-n.y1>0&&(this.full.x1=this.x2-1,this.full.x2=this.x1),this.width=this.x2,this.height=this.y2}pad(t,e,i,r){return this.set(this.x1-t,this.x2+e,this.y1-i,this.y2+r)}findEmptyRect(t,e,i){var r,s,n,o,h,l,a,u,p,d,c,f,m,v,_,x,y;for(t.normalize(),y=o=u=e.y1,p=e.y2;u<=p?o<p:o>p;y=u<=p?++o:--o)for(x=h=d=e.x1,c=e.x2;d<=c?h<c:h>c;x=d<=c?++h:--h){for(r=!1,n=l=f=y+t.y2-1,m=y;(f<=m?l<=m:l>=m)&&!r;n=f<=m?++l:--l)for(s=a=v=x+t.x2-1,_=x;v<=_?a<=_:a>=_;s=v<=_?++a:--a){if(!this.matrix[n]){r=!0;break}if(null!==this.matrix[n][s]){r=!0;break}}if(!1===r)return i.set(x,x+t.x2,y,y+t.y2)}}addTile(t,e,r,s,n){var o,h;return(o=this._temp[0].set(e,r,s,n)).x2>o.x1?o.x2-=t.x2-1:o.x1-=t.x2-1,o.y2>o.y1?o.y2-=t.y2-1:o.y1-=t.y2-1,!(o.y2<0||o.x2<0||o.y1>this.y2||o.x1>this.x2)&&(h=this._temp[1].set(),!!this.findEmptyRect(t,o,h)&&(t.rect=(new i).copy(h),t.rect.loopMatrix(this.matrix,this.setCoordItem,t),!0))}setTileCb(t){return this.clearRect(t),!1}log(){var t,e,i,r;for(console.log("-----------------\n\n"),t=0,e=(i=this.matrix).length;t<e;t++)r=i[t].map(function(t){return t&&String(t[0].item.key)||"- "}),console.log(r.join("     ")+"\n\n");return console.log("-----------------")}},t.exports={Rect:i,Tile:r,TileGrid:s}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var i=e.protocol+"//"+e.host,r=i+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var s,n=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(n)?t:(s=0===n.indexOf("//")?n:0===n.indexOf("/")?i+n:r+n.replace(/^\.\//,""),"url("+JSON.stringify(s)+")")})}},function(t,e,i){var r,s,n={},o=(r=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===s&&(s=r.apply(this,arguments)),s}),h=function(t){var e={};return function(t){if("function"==typeof t)return t();if(void 0===e[t]){var i=function(t){return document.querySelector(t)}.call(this,t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}}(),l=null,a=0,u=[],p=i(3);function d(t,e){for(var i=0;i<t.length;i++){var r=t[i],s=n[r.id];if(s){s.refs++;for(var o=0;o<s.parts.length;o++)s.parts[o](r.parts[o]);for(;o<r.parts.length;o++)s.parts.push(x(r.parts[o],e))}else{var h=[];for(o=0;o<r.parts.length;o++)h.push(x(r.parts[o],e));n[r.id]={id:r.id,refs:1,parts:h}}}}function c(t,e){for(var i=[],r={},s=0;s<t.length;s++){var n=t[s],o=e.base?n[0]+e.base:n[0],h={css:n[1],media:n[2],sourceMap:n[3]};r[o]?r[o].parts.push(h):i.push(r[o]={id:o,parts:[h]})}return i}function f(t,e){var i=h(t.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=u[u.length-1];if("top"===t.insertAt)r?r.nextSibling?i.insertBefore(e,r.nextSibling):i.appendChild(e):i.insertBefore(e,i.firstChild),u.push(e);else if("bottom"===t.insertAt)i.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var s=h(t.insertInto+" "+t.insertAt.before);i.insertBefore(e,s)}}function m(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=u.indexOf(t);e>=0&&u.splice(e,1)}function v(t){var e=document.createElement("style");return t.attrs.type="text/css",_(e,t.attrs),f(t,e),e}function _(t,e){Object.keys(e).forEach(function(i){t.setAttribute(i,e[i])})}function x(t,e){var i,r,s,n;if(e.transform&&t.css){if(!(n=e.transform(t.css)))return function(){};t.css=n}if(e.singleton){var o=a++;i=l||(l=v(e)),r=b.bind(null,i,o,!1),s=b.bind(null,i,o,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(t){var e=document.createElement("link");return t.attrs.type="text/css",t.attrs.rel="stylesheet",_(e,t.attrs),f(t,e),e}(e),r=function(t,e,i){var r=i.css,s=i.sourceMap,n=void 0===e.convertToAbsoluteUrls&&s;(e.convertToAbsoluteUrls||n)&&(r=p(r));s&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */");var o=new Blob([r],{type:"text/css"}),h=t.href;t.href=URL.createObjectURL(o),h&&URL.revokeObjectURL(h)}.bind(null,i,e),s=function(){m(i),i.href&&URL.revokeObjectURL(i.href)}):(i=v(e),r=function(t,e){var i=e.css,r=e.media;r&&t.setAttribute("media",r);if(t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}.bind(null,i),s=function(){m(i)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else s()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=o()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var i=c(t,e);return d(i,e),function(t){for(var r=[],s=0;s<i.length;s++){var o=i[s];(h=n[o.id]).refs--,r.push(h)}t&&d(c(t,e),e);for(s=0;s<r.length;s++){var h;if(0===(h=r[s]).refs){for(var l=0;l<h.parts.length;l++)h.parts[l]();delete n[h.id]}}}};var y,g=(y=[],function(t,e){return y[t]=e,y.filter(Boolean).join("\n")});function b(t,e,i,r){var s=i?"":r.css;if(t.styleSheet)t.styleSheet.cssText=g(e,s);else{var n=document.createTextNode(s),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(n,o[e]):t.appendChild(n)}}},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var i=function(t,e){var i=t[1]||"",r=t[3];if(!r)return i;if(e&&"function"==typeof btoa){var s=(o=r,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),n=r.sources.map(function(t){return"/*# sourceURL="+r.sourceRoot+t+" */"});return[i].concat(n).concat([s]).join("\n")}var o;return[i].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+i+"}":i}).join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},s=0;s<this.length;s++){var n=this[s][0];"number"==typeof n&&(r[n]=!0)}for(s=0;s<t.length;s++){var o=t[s];"number"==typeof o[0]&&r[o[0]]||(i&&!o[2]?o[2]=i:i&&(o[2]="("+o[2]+") and ("+i+")"),e.push(o))}},e}},function(t,e,i){(t.exports=i(5)(!1)).push([t.i,".-i-grid {\n  box-sizing: border-box;\n  perspective: 600px;\n  transform-style: preserve-3d;\n  position: relative;\n  width: 100%;\n  overflow-x: scroll;\n  overflow-y: hidden;\n  height: 100%;\n  -webkit-overflow-scrolling: touch;\n}\n.-i-grid .-i-grid-item {\n  position: absolute;\n  box-sizing: border-box;\n  backface-visibility: hidden;\n  -webkit-backface-visibility: hidden;\n}\n.-i-grid .-i-grid-item::before {\n  will-change: transform;\n}\n.-i-grid .-i-grid-inner {\n  transform-style: inherit;\n  height: inherit;\n  width: auto;\n  position: relative;\n}\n.-i-grid.-i-grid-vert {\n  overflow-Y: scroll;\n  overflow-X: hidden;\n}\n.-i-grid.-i-grid-vert .-i-grid-inner {\n  width: 100%;\n  height: auto;\n}\n.-i-grid.-i-grid-fixed {\n  height: 100%;\n  width: 100%;\n  overflow: hidden;\n}\n",""])},function(t,e,i){var r=i(6);"string"==typeof r&&(r=[[t.i,r,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};i(4)(r,s);r.locals&&(t.exports=r.locals)},function(t,e,i){var r,s,n,o,h,l,a,u,p,d=function(t,e){if(!(t instanceof e))throw new Error("Bound instance method accessed before binding")};({h:p,Component:r}=i(0)),i(7),({TileGrid:a,Tile:l,Rect:h}=i(2)),u=0,s={vert:!0,className:null,fixed:!1,renderRowsPad:0,viewRowsOffset:0,appendRowsCount:5,viewRowsPad:0,postChildren:null,ease:"0.4s cubic-bezier(.29,.3,.08,1)",size:4,endPadding:0,startPadding:0,length:5,animate:!0,variation:1},Math.clamp=function(t,e,i){return Math.min(Math.max(t,e),i)},n=new RegExp("^on[A-Z]"),(o=class t extends r{constructor(t){if(super(t),this.getChildContext=this.getChildContext.bind(this),this.getDim=this.getDim.bind(this),this.getLengthDim=this.getLengthDim.bind(this),this.setDisplayChildren=this.setDisplayChildren.bind(this),this.outer_ref=this.outer_ref.bind(this),this.inner_ref=this.inner_ref.bind(this),this.onScroll=this.onScroll.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.render=this.render.bind(this),0===this.props.appendRowsCount||0===this.size)throw new Error("Grid invalid parameters. @props.appendRowsCount == 0 || @size == 0");this.state={display_children:[],rows_added:0,rows_added:0,children_map:{},render_min:null,render_max:null},this._grid=new a({width:this.props.size,height:1})}passProps(t){var e,i,r;for(i in this.pass_props={},r=[],t)e=t[i],n.test(i)?r.push(this.pass_props[i]=e):r.push(void 0);return r}getChildContext(){return d(this,t),{startPadding:this.props.startPadding,vert:this.props.vert,animate:this.props.animate,size:this.props.size,length:this.props.length,scroll_up:this.state.scroll_up,dim:this.getDim(),ease:this.props.ease,ease_dur:this.props.ease_dur,length_dim:this.getLengthDim(),fixed:this.props.fixed,variation:this.props.variation}}componentWillMount(){return this.passProps(this.props)}componentWillRecieveProps(t){return this.passProps(t)}appendChild(t){var e,i;for(i=new l({width:t.attributes.w,height:t.attributes.h,item:t}),e=[];!this._grid.addTile(i,this._grid.full.x2,this._grid.x2,this._grid.full.y2,this._grid.y2);)e.push(this._grid.pad(0,0,0,this.props.appendRowsCount));return e}prependChild(t){var e,i;for(i=new l({width:t.attributes.w,height:t.attributes.h,item:t}),e=[];!this._grid.addTile(i,0,this._grid.x2,this._grid.full.y1,0);)this._grid.pad(0,0,10,0),e.push(this.state.rows_added+=this.props.appendRowsCount);return e}setChildren(t){var e,i,r,s;for(s=[],i=0,r=t.length;i<r;i++)e=t[i],s.push(this.appendChild(e));return s}appendChildren(t){var e,i,r,s;for(e=i=r=this.props.children.length,s=t.length;r<=s?i<s:i>s;e=r<=s?++i:--i)this.appendChild(t[e]);return this.props.children=t}prependChildren(t){var e,i,r;for(e=i=r=t.length-this.props.children.length-1;r<=0?i<0:i>0;e=r<=0?++i:--i)this.prependChild(t[e]);return this.props.children=t}roundDim(t){var e;return t=(e=Math.round(t)-t)>-.5&&e<0?Math.round(t+.5):Math.round(t)}getDim(){var e;return d(this,t),this._outer?(e=this.props.vert?this._inner.clientWidth/this.props.size:this._outer.clientHeight/this.props.size,this.roundDim(e)):0}getLengthDim(){var e;return d(this,t),this._outer?(e=this.props.vert?this.props.fixed?this._inner.clientHeight/this.props.length:this.props.dim||this._outer.clientWidth/this.props.size:this.props.fixed?this._inner.clientWidth/this.props.length:this.props.dim||this._outer.clientHeight/this.props.length,this.roundDim(e)):0}updateGrid(t,e){var i;return i=!e.fixed&&e.children[0]&&t.children[0]&&e.children[0].key!==t.children[0].key,e.children.length>t.children.length&&(i?this.prependChildren(e.children):this.appendChildren(e.children),this.setDisplayChildren(),this.forceUpdate(),!0)}setDisplayChildren(){var e,i,r,s,n,o,h,l,a,u,p,c,f,m,v,_,x,y,g,b,w,C,M,k,N;if(d(this,t),C=this.updateScrollPosition(),this.props.vert?(c=this._outer.clientHeight,p=C-this.props.startPadding):(c=this._outer.clientWidth,p=C-this.props.startPadding),s=this.getLengthDim(),h=this._grid.matrix.length?this._grid.matrix.length-1:0,v=_=!0,m=Math.clamp(Math.floor(p/s)-this.props.viewRowsOffset,0,h),f=Math.clamp(Math.floor((p+c)/s)+this.props.viewRowsOffset,0,h),m>=this.state.render_min&&f<=this.state.render_max&&0!==f?v=!1:this.state.scroll_up?(this.state.render_min=Math.clamp(m-this.props.renderRowsPad,0,h),this.state.render_max=f):(this.state.render_min=m,this.state.render_max=Math.clamp(f+this.props.renderRowsPad,0,h)),m>=this.state.view_min&&f<this.state.view_max||!1===this.props.animate?_=!1:this.state.scroll_up?(this.state.view_min=Math.clamp(m-this.props.viewRowsPad,0,h),this.state.view_max=f):(this.state.view_min=m,this.state.view_max=Math.clamp(f+this.props.viewRowsPad,0,h)),v){for(this.state.display_children=[],e={},w=n=x=this.state.render_min,y=this.state.render_max;x<=y?n<=y:n>=y;w=x<=y?++n:--n)for(r=o=0,l=(g=this._grid.matrix[w]).length;o<l;r=++o)null!==(M=g[r])&&(i=M[0].item,k=M[1],N=M[2],void 0===e[i.key]&&(e[i.key]=!0,i.attributes.r=w-N,i.attributes.c=r-k,this.props.animate?w>=this.state.view_min&&w<=this.state.view_max?i.attributes.visible=!0:i.attributes.visible=!1:i.attributes.visible=!0,this.state.scroll_up?this.state.display_children.push(i):this.state.display_children.unshift(i)));return!0}if(_){for(u=0,a=(b=this.state.display_children).length;u<a;u++)(i=b[u]).attributes.r+i.attributes.h>this.state.view_min&&i.attributes.r<=this.state.view_max?i.attributes.visible=!0:i.attributes.visible=!1;return!0}return!1}setScroll(t){return t=t||0,this.props.vert&&this._outer.scrollTop!==t?(this._outer.scrollHeight<t&&(this._inner.style.height=t+this._outer.clientHeight),this._outer.scrollTop=t,this._outer.scrollTop=t):this._outer.scrollLeft!==t&&(this._outer.scrollLeft=t),t}updateScrollPosition(){var t,e,i;return this.props.vert?(e=this._outer.scrollTop,i=this._outer.clientWidth):(e=this._outer.scrollLeft,i=this._outer.clientHeight),i!==this.state.size&&(t=i/this.state.size,this.state.size=i,e=this.setScroll(e*t)),this.state.rows_added&&(e=this.setScroll(e+this.state.rows_added*this.getLengthDim()),this.state.rows_added=0),e}componentDidMount(){return this.props.fixed?(this.setChildren(this.props.children),this.state.display_children=this.props.children):(this.setChildren(this.props.children),this.setDisplayChildren()),this.forceUpdate()}componentWillUpdate(t){var e;if(!this.updateGrid(this.props,t)&&(e=this.getDim())&&e!==this._dim)return this.setDisplayChildren()}componentDidUpdate(t){return this._dim=this.getDim(),this._l_dim=this.getLengthDim(),this._rect=this._outer.getBoundingClientRect(),this.updateScrollPosition()}outer_ref(e){return d(this,t),this._outer=e}inner_ref(e){return d(this,t),this._inner=e}getOuterProps(){var t;return(t=Object.assign({key:this.key,ref:this.outer_ref,className:`-i-grid ${this.props.vert?"-i-grid-vert":""} ${this.props.fixed?"-i-grid-fixed":""} ${this.props.className||this.props.outerClassName}`},this.pass_props)).onScroll=this.onScroll,t}getInnerProps(){var t,e,i;return e=this.getLengthDim()*this._grid.y2+this.props.endPadding+this.props.startPadding,this.props.vert?this.props.fixed?(t="100%",i="100%"):(t=e+"px",i="100%"):this.props.fixed?(i="100%",t="100%"):(i=e+"px",t="100%"),{ref:this.inner_ref,className:`-i-grid-inner ${this.props.innerClassName||""}`,style:{width:i,height:t}}}onScroll(){var e;if(d(this,t),e=this.props.vert?this._outer.scrollTop:this._outer.scrollLeft,this.state.last_scroll>e?this.state.scroll_up=!0:this.state.scroll_up=!1,this.state.last_scroll!==e&&(this.state.last_scroll=e,this.setDisplayChildren()))return this.forceUpdate()}onMouseMove(e){var i,r;if(d(this,t),this.props.onUnitMouseEnter)return this._rect=this._outer.getBoundingClientRect(),u=Math.floor((e.clientX-this._rect.x)/this._dim),i=Math.floor((e.clientY-this._rect.y)/this._l_dim),this._mouse_c===u&&this._mouse_r===i||this.props.onUnitMouseEnter(i,u,null!=(r=this.state.matrix[i])?r[u]:void 0),this._mouse_c=u,this._mouse_r=i}render(){var e,i;return d(this,t),i=this.getOuterProps(),e=this.getInnerProps(),p("div",i,p("div",e,this.state.display_children,this.props.postChildren))}}).defaultProps=s,t.exports=o},function(t,e,i){t.exports.Grid=i(8),t.exports.GridItem=i(1)}])});
//# sourceMappingURL=lib.js.map